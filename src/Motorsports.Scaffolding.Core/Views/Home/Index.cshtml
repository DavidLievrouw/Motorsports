@using Motorsports.Scaffolding.Core.Services

@model Motorsports.Scaffolding.Core.Models.DisplayModels.HomeDisplayModel

@inject IImageService _imageService

@{
  ViewData["Title"] = "Home";
}

<div id="menu">
  <blockquote class="homeHeader">
    <h4>Next up</h4>
  </blockquote>
  @if (Model.HasVeryNextUp) {
    @Html.Partial("NextUp", Model.VeryNextUp)
  }
  @if (Model.HasNextUpPerSport) {
    foreach (var nextUp in Model.NextUpPerSport) {
      @Html.Partial("NextUp", nextUp)
    }
  }
  else {
    if (!Model.HasVeryNextUp) {
      <div class="disabledLink">[No rounds next up]</div>
    }
  }
  <script>
    $(document).ready(function() {
      var maxHeight = 0;

      $("div.nextUp").each(function() {
        if ($(this).height() > maxHeight) {
          maxHeight = $(this).height();
        }
      });

      $("div.nextUp").height(maxHeight);
    });
  </script>
  @if (Model.HasRoundsToAcquire) {
    <blockquote class="homeHeader">
      <h4>Rounds to acquire</h4>
    </blockquote>
    <table class="table">
      <thead>
      <tr>
        <th>
          @Html.DisplayNameFor(model => model.RoundsToAcquire)
        </th>
        <th>
          @Html.DisplayNameFor(model => model.RoundsToAcquire.First().Number)
        </th>
        <th>
          @Html.DisplayNameFor(model => model.RoundsToAcquire.First().Date)
        </th>
        <th>
          @Html.DisplayNameFor(model => model.RoundsToAcquire.First().Venue)
        </th>
        <th>
        </th>
      </tr>
      </thead>
      <tbody>
      @foreach (var round in Model.RoundsToAcquire) {
        <tr>
          <td>
            <div>
              <div class="roundsToAcquireLogo">
                <a asp-action="Details" asp-controller="Rounds" asp-route-id="@round.Id">
                  <img class="sportlogo" src="@_imageService.GetSportLogo(round.Sport)" alt="@round.Sport"/>
                </a>
              </div>
              <div class="roundsToAcquireName">
                <a asp-action="Details" asp-controller="Rounds" asp-route-id="@round.Id">
                  @Html.DisplayFor(modelItem => round.Sport)
                </a>
              </div>
            </div>
          </td>
          <td>
            @Html.DisplayFor(modelItem => round.Number)
          </td>
          <td>
            @Html.DisplayFor(modelItem => round.Date)
          </td>
          <td>
            @Html.DisplayFor(modelItem => round.Venue)
          </td>
          <td>
            <a asp-action="MarkReadyToWatch" asp-controller="Rounds" asp-route-id="@round.Id">Ready to watch</a>
          </td>
        </tr>
      }
      </tbody>
    </table>
  }
  @if (Model.HasLatestSeasons) {
    <blockquote class="homeHeader">
      <h4>Latest seasons</h4>
    </blockquote>
    <table class="table">
      <thead>
      <tr>
        <th>
          @Html.DisplayNameFor(model => model.LatestSeasons)
        </th>
        <th>
          @Html.DisplayNameFor(model => model.LatestSeasons.First().StartDate)
        </th>
        <th>
          @Html.DisplayNameFor(model => model.LatestSeasons.First().EndDate)
        </th>
        <th>
        </th>
      </tr>
      </thead>
      <tbody>
      @foreach (var season in Model.LatestSeasons) {
        <tr>
          <td>
            <div>
              <div class="latestSeasonLogo">
                <a asp-action="Index" asp-controller="Rounds" asp-route-id="@season.Id">
                  <img class="sportlogo" src="@_imageService.GetSportLogo(season.Sport)" alt="@season.Sport"/>
                </a>
              </div>
              <div class="latestSeasonName">
                <a asp-action="Index" asp-controller="Rounds" asp-route-id="@season.Id">
                  @Html.DisplayFor(modelItem => season.DataModel)
                </a>
              </div>
            </div>
          </td>
          <td>
            @Html.DisplayFor(modelItem => season.StartDate)
          </td>
          <td>
            @Html.DisplayFor(modelItem => season.EndDate)
          </td>
          <td>
            <a asp-action="Edit" asp-controller="Seasons" asp-route-id="@season.Id">Edit</a> |
            <a asp-action="Details" asp-controller="Seasons" asp-route-id="@season.Id">Details</a>
          </td>
        </tr>
      }
      </tbody>
    </table>
  }
  <blockquote class="homeHeader">
    <h4>Master data</h4>
  </blockquote>
  <table class="table">
    <tbody>
    <tr>
      <td>
        <a asp-controller="Sports" asp-action="Index">Sports</a>
      </td>
    </tr>
    <tr>
      <td>
        <a asp-controller="Venues" asp-action="Index">Venues</a>
      </td>
    </tr>
    <tr>
      <td>
        <a asp-controller="Teams" asp-action="Index">Teams</a>
      </td>
    </tr>
    <tr>
      <td>
        <a asp-controller="Participants" asp-action="Index">Participants</a>
      </td>
    </tr>
    <tr>
      <td>
        <a asp-controller="Seasons" asp-action="Index">Seasons</a>
      </td>
    </tr>
    </tbody>
  </table>
</div>