@using System.Collections

@model string

@{
  var allCountries = ((IEnumerable)ViewData["Countries"]).OfType<Country>();
  var selectedCountry = (string)ViewData["SelectedCountry"];
  var targetProperty = ViewData["TargetProperty"] ?? "Country";
}

<link href="/css/select2.css" rel="stylesheet" />
<script src="/js/select2.full.js"></script>

<select name="@targetProperty" id="slcCountries" class="form-control">
  @{
    foreach (var country in allCountries) {
      <option value="@country.Iso">@country.NiceName (@country.Iso)</option>
    }
  }
</select>

<script>
  $(document).ready(function() {
    var $countries = $("#slcCountries");
    $countries.select2({
      placeholder: "Select a country"
    });
    $countries.val("@selectedCountry");
    $countries.trigger("change"); // Notify any JS components that the value changed
  });
</script>
